<!DOCTYPE html>
<html lang="en">
	<head>
		<!-- Google Tag Manager -->
		<script>
			(function (w, d, s, l, i) {
				w[l] = w[l] || [];
				w[l].push({ "gtm.start": new Date().getTime(), event: "gtm.js" });
				var f = d.getElementsByTagName(s)[0],
					j = d.createElement(s),
					dl = l != "dataLayer" ? "&l=" + l : "";
				j.async = true;
				j.src = "https://www.googletagmanager.com/gtm.js?id=" + i + dl;
				f.parentNode.insertBefore(j, f);
			})(window, document, "script", "dataLayer", "GTM-WZR23N7");
		</script>
		<!-- End Google Tag Manager -->
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<!-- Paddle -->
		<title>Vanilla Checkout Test</title>
		<script src="https://cdn.paddle.com/paddle/paddle.js"></script>
		<!-- Global site tag (gtag.js) - Google Analytics -->
		<!-- Global site tag (gtag.js) - Google Analytics -->
		<script
			async
			src="https://www.googletagmanager.com/gtag/js?id=UA-204235388-1"
		></script>
		<script>
			window.dataLayer = window.dataLayer || [];
			function gtag() {
				dataLayer.push(arguments);
			}
			gtag("js", new Date());

			gtag("config", "UA-204235388-1");
		</script>
	</head>
	<body>
		<!-- Google Tag Manager (noscript) -->
		<noscript
			><iframe
				src="https://www.googletagmanager.com/ns.html?id=GTM-WZR23N7"
				height="0"
				width="0"
				style="display: none; visibility: hidden"
			></iframe
		></noscript>
		<!-- End Google Tag Manager (noscript) -->
		<h1>GA Test</h1>
		<a href="#!" id="buy">Buy now!</a>
	</body>
	<script type="text/javascript">
		Paddle.Setup({
			vendor: 2712,
		});
		Paddle.Environment.set("sandbox");
	</script>
	<script type="text/javascript">
		function openCheckout() {
			Paddle.Checkout.open({
				product: 13941,
				successCallback: function (data) {
					dataLayer.push({ ecommerce: null });
					dataLayer.push({
						event: "purchase",
						campaign: "Solutions Architect Challenge",
						ecommerce: {
							currencyCode: data.checkout.prices.customer.currency,
							purchase: {
								actionField: {
									id: data.checkout.id,
									affiliation: "Store Example",
									revenue: data.checkout.prices.customer.total,
									tax: data.checkout.prices.customer.total_tax,
									coupon: data.checkout.coupon.coupon_code,
								},
								products: [
									{
										name: data.product.name,
										id: data.product.id,
										price: data.checkout.prices.customer.total,
										brand: "GA Test",
										quantity: data.product.quantity,
									},
								],
							},
						},
					});
				},
				closeCallback: function (data) {
					dataLayer.push({ event: "checkoutClose" });
				},
			});
		}
		document
			.getElementById("buy")
			.addEventListener("click", openCheckout, false);
	</script>
</html>
